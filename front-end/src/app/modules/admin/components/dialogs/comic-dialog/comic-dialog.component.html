<form [formGroup]="form" novalidate>
  <h2 mat-dialog-title>Quadrinho</h2>

  <mat-dialog-content>
    <div>
      <mat-form-field>
        <input matInput placeholder="Titulo" formControlName="title" />
      </mat-form-field>
      <mat-form-field>
        <input
          type="number"
          matInput
          placeholder="Preço"
          formControlName="price"
        />
      </mat-form-field>
      <mat-form-field>
        <input
          type="number"
          matInput
          placeholder="Ano"
          formControlName="year"
        />
      </mat-form-field>
    </div>

    <div>
      <mat-form-field>
        <input
          type="number"
          matInput
          placeholder="Nº Páginas"
          formControlName="pages"
        />
      </mat-form-field>

      <mat-form-field>
        <mat-select
          [formControl]="authorsControl"
          [multiple]="true"
          placeholder="Autores"
          #multiSelect
        >
          <mat-option>
            <ngx-mat-select-search
              [formControl]="authorsSearchControl"
              [searching]=""
              placeholderLabel="Digite pelo menos 3 caracteres"
              noEntriesFoundLabel="'Nenhum item foi encontrado'"
            >
            </ngx-mat-select-search>
          </mat-option>
          <mat-option
            *ngFor="let author of filteredAuthorsOptions$ | async"
            [value]="author.authorID"
          >
            {{ author.name }}
          </mat-option>
        </mat-select>
      </mat-form-field>

      <mat-form-field>
        <mat-select
          [formControl]="genresControl"
          placeholder="Categorias"
          [multiple]="true"
          #multiSelect
        >
          <mat-option>
            <ngx-mat-select-search
              [formControl]="genresSearchControl"
              placeholderLabel="pesquisar"
            ></ngx-mat-select-search>
          </mat-option>
          <mat-option
            *ngFor="let genre of filteredGenresOptions$ | async"
            [value]="genre.genreID"
          >
            {{ genre.description }}
          </mat-option>
        </mat-select>
      </mat-form-field>
    </div>

    <div style="width: 100%">
      <mat-form-field style="width: 100%">
        <textarea
          placeholder="Descrição"
          formControlName="description"
          matInput
          rows="7"
        ></textarea>
      </mat-form-field>
    </div>

    <mat-form-field>
      <ngx-mat-file-input
        [formControl]="imageControl"
        placeholder="Imagem"
        accept="image/png,image/jpg,image/gif,image/jpeg"
        (change)="loadImageTeste($event)"
      ></ngx-mat-file-input>
      <mat-icon matSuffix>folder</mat-icon>
    </mat-form-field>

    <div class="preview-image-action">
      <p>Pre-Visualização:</p>
      <button
        (click)="loadComicImage(comic.comicID)"
        *ngIf="!!comic?.comicID"
        class="mat-raised-button mat-primary"
      >
        Carregar
      </button>
    </div>

    <div class="preview-image">
      <img [src]="imageDataUrl" *ngIf="imageDataUrl" />
    </div>
  </mat-dialog-content>

  <mat-dialog-actions>
    <button class="mat-raised-button" (click)="close()">Fechar</button>
    <button
      [disabled]="form.invalid"
      [class.disabled]="form.invalid"
      class="mat-raised-button mat-primary"
      (click)="save()"
    >
      Salvar
    </button>
  </mat-dialog-actions>
</form>
